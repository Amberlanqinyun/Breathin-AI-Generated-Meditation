from db_baseOperation import execute_query
from datetime import datetime

def get_user_meditation_history(user_id):
    query = 'SELECT * FROM MeditationSessions WHERE UserID = %s ORDER BY SessionDate DESC'
    return execute_query(query, data=(user_id,))


def get_user_achievements(user_id):
    query = 'SELECT * FROM Achievements WHERE UserID = %s ORDER BY AchievedAt DESC'
    return execute_query(query, data=(user_id,))


def get_user_meditation_activity(user_id):
    query = '''
    SELECT DATE(SessionDate) as date, COUNT(*) as count 
    FROM MeditationSessions 
    WHERE UserID = %s 
    GROUP BY DATE(SessionDate)
    '''
    return execute_query(query, data=(user_id,))
